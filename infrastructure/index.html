<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端基础建设 | zhongxia</title>
    <meta name="description" content="乾坤未定，你我皆是黑马">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.eff4c7fd.css" as="style"><link rel="preload" href="/assets/js/app.78d817e6.js" as="script"><link rel="preload" href="/assets/js/2.39175ddf.js" as="script"><link rel="preload" href="/assets/js/14.8bce90c6.js" as="script"><link rel="prefetch" href="/assets/js/10.e2dc9b9a.js"><link rel="prefetch" href="/assets/js/11.d1696dae.js"><link rel="prefetch" href="/assets/js/12.38c301d0.js"><link rel="prefetch" href="/assets/js/13.a02ac391.js"><link rel="prefetch" href="/assets/js/15.66cfd5f9.js"><link rel="prefetch" href="/assets/js/16.3a9702b5.js"><link rel="prefetch" href="/assets/js/17.2c71248c.js"><link rel="prefetch" href="/assets/js/18.931a1317.js"><link rel="prefetch" href="/assets/js/19.7ee21b78.js"><link rel="prefetch" href="/assets/js/20.bf5faa4b.js"><link rel="prefetch" href="/assets/js/21.f6f7b4f6.js"><link rel="prefetch" href="/assets/js/22.08ccde32.js"><link rel="prefetch" href="/assets/js/23.471c6876.js"><link rel="prefetch" href="/assets/js/24.fee1a2e8.js"><link rel="prefetch" href="/assets/js/25.99afd69e.js"><link rel="prefetch" href="/assets/js/26.17ee536a.js"><link rel="prefetch" href="/assets/js/27.fffc8c7f.js"><link rel="prefetch" href="/assets/js/28.646afabb.js"><link rel="prefetch" href="/assets/js/29.077ddd70.js"><link rel="prefetch" href="/assets/js/3.03805157.js"><link rel="prefetch" href="/assets/js/30.1a8d2492.js"><link rel="prefetch" href="/assets/js/31.0fee5d09.js"><link rel="prefetch" href="/assets/js/32.6dfc0d63.js"><link rel="prefetch" href="/assets/js/33.cb03d76b.js"><link rel="prefetch" href="/assets/js/34.9bd6d183.js"><link rel="prefetch" href="/assets/js/35.9998c252.js"><link rel="prefetch" href="/assets/js/36.03416c13.js"><link rel="prefetch" href="/assets/js/37.448dec73.js"><link rel="prefetch" href="/assets/js/38.ae0cbce2.js"><link rel="prefetch" href="/assets/js/39.ee104725.js"><link rel="prefetch" href="/assets/js/4.b3dec607.js"><link rel="prefetch" href="/assets/js/40.eb2ee867.js"><link rel="prefetch" href="/assets/js/41.edc3b4d4.js"><link rel="prefetch" href="/assets/js/42.f55059ef.js"><link rel="prefetch" href="/assets/js/43.2372c02d.js"><link rel="prefetch" href="/assets/js/44.ee104c41.js"><link rel="prefetch" href="/assets/js/45.4aeb260f.js"><link rel="prefetch" href="/assets/js/46.cb8e2144.js"><link rel="prefetch" href="/assets/js/47.2897ca06.js"><link rel="prefetch" href="/assets/js/48.ff6c4720.js"><link rel="prefetch" href="/assets/js/49.321a4e12.js"><link rel="prefetch" href="/assets/js/5.d780f13b.js"><link rel="prefetch" href="/assets/js/50.5d535131.js"><link rel="prefetch" href="/assets/js/51.d217ec3f.js"><link rel="prefetch" href="/assets/js/52.451208e5.js"><link rel="prefetch" href="/assets/js/53.3c0e386e.js"><link rel="prefetch" href="/assets/js/54.457bfa09.js"><link rel="prefetch" href="/assets/js/55.2ab3005f.js"><link rel="prefetch" href="/assets/js/56.1c46fa32.js"><link rel="prefetch" href="/assets/js/57.2f6eb766.js"><link rel="prefetch" href="/assets/js/58.69bc73b8.js"><link rel="prefetch" href="/assets/js/59.e895e676.js"><link rel="prefetch" href="/assets/js/6.38dbf43a.js"><link rel="prefetch" href="/assets/js/60.633e1e62.js"><link rel="prefetch" href="/assets/js/61.b94dcbd7.js"><link rel="prefetch" href="/assets/js/62.3fd8ffe0.js"><link rel="prefetch" href="/assets/js/63.d23cee23.js"><link rel="prefetch" href="/assets/js/64.5b342174.js"><link rel="prefetch" href="/assets/js/65.c3a714d4.js"><link rel="prefetch" href="/assets/js/66.d93cc18b.js"><link rel="prefetch" href="/assets/js/67.0ca3c871.js"><link rel="prefetch" href="/assets/js/68.8389f128.js"><link rel="prefetch" href="/assets/js/69.9e07bc24.js"><link rel="prefetch" href="/assets/js/7.939ddc41.js"><link rel="prefetch" href="/assets/js/70.9051c464.js"><link rel="prefetch" href="/assets/js/71.b9c566ce.js"><link rel="prefetch" href="/assets/js/72.7a0a2035.js"><link rel="prefetch" href="/assets/js/73.d2d4670b.js"><link rel="prefetch" href="/assets/js/74.83d8b9d1.js"><link rel="prefetch" href="/assets/js/75.1e397728.js"><link rel="prefetch" href="/assets/js/76.6c23c88e.js"><link rel="prefetch" href="/assets/js/77.7a658dae.js"><link rel="prefetch" href="/assets/js/78.03938428.js"><link rel="prefetch" href="/assets/js/79.fe1ddcd8.js"><link rel="prefetch" href="/assets/js/8.f44495b7.js"><link rel="prefetch" href="/assets/js/80.bc5ec8dd.js"><link rel="prefetch" href="/assets/js/81.bb6ac0cc.js"><link rel="prefetch" href="/assets/js/82.284cb998.js"><link rel="prefetch" href="/assets/js/83.35f9364b.js"><link rel="prefetch" href="/assets/js/84.fceeb27d.js"><link rel="prefetch" href="/assets/js/85.e61d68d6.js"><link rel="prefetch" href="/assets/js/86.30ecd90a.js"><link rel="prefetch" href="/assets/js/87.b7b40006.js"><link rel="prefetch" href="/assets/js/88.1b3b8cd5.js"><link rel="prefetch" href="/assets/js/89.b3204fc6.js"><link rel="prefetch" href="/assets/js/9.886a53af.js"><link rel="prefetch" href="/assets/js/90.e05b8f8c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.eff4c7fd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">zhongxia</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/post/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/old/" class="nav-link">
  早期文章
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题
</a></div><div class="nav-item"><a href="/faq/" class="nav-link">
  兼容问题
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <a href="https://github.com/zhongxia245/zhongxia245.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/post/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/old/" class="nav-link">
  早期文章
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题
</a></div><div class="nav-item"><a href="/faq/" class="nav-link">
  兼容问题
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <a href="https://github.com/zhongxia245/zhongxia245.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端基础建设"><a href="#前端基础建设" class="header-anchor">#</a> 前端基础建设</h1> <p>一个前端工程师，天然会在职业不同阶段，处在 技术型选手、业务型选手、管理型选手 交叉的象限中。</p> <p>无论是哪一种选手，从初级迈向技术专家的路程上，除了做业务和管理外，具备前端基建方法论都是一个能力刚需。</p> <p>这里主要介绍下都有什么类型的基础建设，没有就得实施方案。</p> <h2 id="一、基础建设都需要哪些部分？"><a href="#一、基础建设都需要哪些部分？" class="header-anchor">#</a> 一、基础建设都需要哪些部分？</h2> <h3 id="_1-1、高优先级"><a href="#_1-1、高优先级" class="header-anchor">#</a> 1.1、高优先级</h3> <ol><li>版本管理：Gitlab</li> <li>持续集成：CI/CD + 自建 CI server + runner</li> <li>统一无配置 webpack 脚手架</li> <li>部署平台</li> <li>日志平台（百度统计，谷歌统计，自建日志系统（kibana））</li> <li>错误监控（sentry， 自建错误统计平台）</li></ol> <h3 id="_1-2、可选"><a href="#_1-2、可选" class="header-anchor">#</a> 1.2、可选</h3> <ol><li>运营活动平台</li> <li>可视化后台系统</li> <li>自建 UI 组件库</li></ol> <h2 id="二、优先级高的前端基础设施"><a href="#二、优先级高的前端基础设施" class="header-anchor">#</a> 二、优先级高的前端基础设施</h2> <h4 id="_1-1-1、版本管理：gitlab"><a href="#_1-1-1、版本管理：gitlab" class="header-anchor">#</a> 1.1.1、版本管理：Gitlab</h4> <p>代码是公司的私有资产，正常企业都不会把代码放在别人的服务器上，因此自己搭建一个管理代码的。</p> <p>目前最常用的是 gitlab , 也有用 svn 的。</p> <p>gitlab 如何搭建看 gitlab 官网即可。</p> <h4 id="_2-2、持续集成"><a href="#_2-2、持续集成" class="header-anchor">#</a> 2.2、持续集成</h4> <p>git 提交代码后，可以通过 CI/CD 配置需要执行的命令</p> <p>比如：eslint 检查，代码构建，自动部署上线</p> <p>部署上线需要看项目的部署环境。从进入公司到现在，部署方式可以分为三个阶段</p> <p>第一阶段：CI/CD 只有 eslint 和 构建，然后把构建的资源手动上传到云服务器，实现部署</p> <p>第二阶段：CI/CD 只有 eslint 和 构建，然后实现一个部署后台，自动下载构建的资源，然后可视化上传到云服务器，实现部署</p> <p>第三节点：CI/CD 直接实现，eslint , 构建静态资源，构建docker 包， 部署docker 上线 的操作。</p> <blockquote><p>如何构建 docker 包，如果把 docker 包部署起来，这个需要 K8S 的基础设施。当然部署 docker 并不是简单的把 docker 启动起来，需要分配 docker 端口，需要为每个运行起来的 docker 分配域名，需要支持自定义 nginx 配置等等。</p> <p>不过这些可能需要运维同学来弄，或者专门研究下。（目前只是运用了现成的基础设施）</p></blockquote> <h4 id="_2-3、统一无配置-webpack-脚手架"><a href="#_2-3、统一无配置-webpack-脚手架" class="header-anchor">#</a> 2.3、统一无配置 webpack 脚手架</h4> <p>如果公司只有一个项目，那么这个倒没有那么重要，但是正常公司都会有很多项目，或者说技术人员会把一个大的项目，拆分成很多个子项目。</p> <p>如果项目脚手架需要升级，那么多个项目如果统一升级呢？每个项目都改一遍配置，这个费时费力，并且不靠谱。</p> <p>解决这个问题，我司也走了很多步</p> <ol><li>前后端未分离（前端 react+ webpack + gulp ， 后端 python）</li> <li>前后端分离，各个项目都有自己的 webpack 配置（前端后分离是一个一个项目来，所以配置不一样）</li> <li>自己封装 global-fe 脚手架（封装 webpack 配置），其他逻辑项目都 软链到 global-fe 的 src 目录下，这样就保证所有逻辑项目都有统一的 webpack配置</li> <li>基于 蚂蚁金服开源的 umi 框架，封装适合自己的插件，无缝迁移之前运用 global-fe 的代码。</li></ol> <h4 id="_4、部署平台"><a href="#_4、部署平台" class="header-anchor">#</a> .4、部署平台</h4> <p>部署的环境分为，测试环境，预发布环境，线上环境</p> <p>部署平台需要支持快速回滚版本，方便上线有问题，快速回滚到老版本。</p> <blockquote><p>目前我们使用的是，每个特定分支的 commit 会构建出一个 独立docker，因此回滚只需要改变部署之前那个 commit 的 生成的 docker 即可。</p></blockquote> <h4 id="_2-5、日志平台"><a href="#_2-5、日志平台" class="header-anchor">#</a> 2.5、日志平台</h4> <p>页面部署上线了，页面的 PV，UV, 某个按钮的点击次数，用户点击路径等等，让数据分析师有数据可分析。</p> <p>如果只是简单的看访问量，可以用 百度统计，谷歌统计</p> <p>如果想要自己搭建日志平台，可以使用开源的 kibana</p> <h4 id="_2-6、错误监控"><a href="#_2-6、错误监控" class="header-anchor">#</a> 2.6、错误监控</h4> <p>代码部署上线了，并不是就结束了，需要做的线上的代码是不是有报错，什么系统，什么用户，哪行代码报错，错误是什么？</p> <blockquote><p>虽然测试同学测试通过才能上线，但是测试通过并不是就一定没有 bug 了，有可能用于用户设备版本低，网络问题，瞎操作什么的，导致报错。</p></blockquote> <p>错误监控有几个需要注意的问题</p> <ol><li>现在上传的代码都是经过构建压缩的，直接看压缩代码，很难定位具体哪个代码报错，因为需要和 source map 做映射。</li> <li>如何监听获取错误信息，最简单的是 监听 window.onerror</li> <li>错误统计，需要抽样上交。</li></ol> <h2 id="三、可选部分"><a href="#三、可选部分" class="header-anchor">#</a> 三、可选部分</h2> <h3 id="_3-1、运营活动系统"><a href="#_3-1、运营活动系统" class="header-anchor">#</a> 3.1、运营活动系统</h3> <p>如果公司的运营活动特别多，并且运营活动是有规律的（客户同学来来回回就是那么几个模式换着来做活动）。</p> <p>比如运营活动，主要目的是 拉新，促销，提升用户活跃度，然后活动的形式，来来回回就是那么几个。因此我们可以做 一个运营活动平台，然后抽象除一些常用的功能模块，通过可视化配置，完成活动开发。</p> <h3 id="_3-2、可视化后台系统"><a href="#_3-2、可视化后台系统" class="header-anchor">#</a> 3.2、可视化后台系统</h3> <p>一个业务需求，如果做出来了，需要长期运营的话，那么正常都会 有一个管理后台让运营同学和产品来管理数据。</p> <p>一个需求对应一个后台，那么要是来10个需求，那么不是要做10个后台？每个后台的页面，还基本都是增删改查。做这些属于技术难度低，技术成长低的工作。</p> <p>可以创建一个可视化后台，后端同学写完接口，再通过简单的可视化配置，就能完成 CRUD 页面的开发。不用说这个后台系统可以配置100%的需求，只要解决80%常规的 CRUD 页面，就可以节省很多时间。</p> <blockquote><p>目前我司的可视化后台，已经有4个业务线，采用该平台，配置了将近200个后台页面了。</p></blockquote> <h3 id="_3-3、自建-ui-组件库"><a href="#_3-3、自建-ui-组件库" class="header-anchor">#</a> 3.3、自建 UI 组件库</h3> <p>这个最好喝设计师沟通下，封装一些常用的组件。之后设计师涉及的时候，有现成的，可以直接用现成的，同样的，前端也可以直接用。这样可以提升一些效率。</p> <blockquote><p>弹窗，关闭按钮，有时候在右上角，有时候在弹窗下中间位置，经常不一样，导致每次弹窗都需要重新写，非常麻烦。如果约定好了，使用弹窗，只要写好文案，就 ok 了，这样大家都方便，设计快，开发也快。</p></blockquote></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zhongxia245/zhongxia245.github.io/edit/docs/docs/infrastructure/README.md" target="_blank" rel="noopener noreferrer">Edit</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/17/2020, 6:39:09 PM</span></div></footer> <!----> </main></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-566b5166 data-v-566b5166><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-566b5166><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-566b5166></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-566b5166></path></svg></div></div></div>
    <script src="/assets/js/app.78d817e6.js" defer></script><script src="/assets/js/2.39175ddf.js" defer></script><script src="/assets/js/14.8bce90c6.js" defer></script>
  </body>
</html>
